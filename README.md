# LegIK_6DoF_forKHR3
以前作成したKHRタイプ軸構成（オフセットあり）のロボット向けの6DoF解析IK関数です。  
バグなど直して導出方法込で公開したかったのですが、手が回っておらず、早く次のことを試したいため、この段階で公開させていただきます。  
数値解手法と比較して計算量が軽いので、二名川さん（@Ninagawa123）達のMeridian Boardなどにもさくっと組み込めます。とりあえず試してみたい人におすすめです。  
（流行りの学習制御の学習用モーション作成にもどうぞ）  
![171871771-ec8df6c7-f930-45d5-8c56-b2ec17ea254c](https://github.com/user-attachments/assets/2b2be039-b416-4f8f-8ab9-44840749aede)  
（上記イラストでは省略していますが、コードでは股間Yaw軸→Roll軸の接続におけるY方向のオフセットも考慮しています）  
　　
# デモ動画  
左足：足裏をXYZ移動＆RollPitch回転後に、移動後の足裏座標系を基準にYaw回転しています。  
右足：標準的な歩行パターン生成結果を、このIKを用いて関節角に変換した結果です。(実行可能な関節角に変換できていることがわかります)
  ![SmartSelect_20250624_060739_Gallery](https://github.com/user-attachments/assets/74709b65-a578-4b6b-9628-14d1b96cb3df)  


#  ToDo
とりあえず  
6DoF_IK_KHRTYPE/src$ g++ main.cpp merkhr_nwk.cpp  -lm  
でコンパイルして下記で実行すると  
6DoF_IK_KHRTYPE/src$ ./a.out  
theta0~5 : 0.000000, 0.046220, 1.337030. -2.674060. 1.337030, -0.044627  
と関節角が表示されるようになっています。  

※本コードはMITライセンスです  
※作者：野分機械@RoboSafs01075  
※解いたときのドキュメントが半分しか残っていなかったので、正確にどう解いたかわかりません。  
※バグもおそらく多いのですが、標準的な範囲内では基本バグりません。  
※それらしく動きますが、足裏姿勢(Pitch, Roll)が極端な姿勢になるとバグります  
